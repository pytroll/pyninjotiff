name: Test deploy sdist

on:
  - push
  - pull_request

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout source
        uses: actions/checkout@v2

      - name: Install Poetry
        uses: abatilo/actions-poetry@v2.0.0

      - name: Build and publish to pypi
        run: poetry config pypi-token.testpypi ${{ secrets.pypi_password }} && poetry config repositories.testpypi https://test.pypi.org/legacy/ && poetry build && poetry publish --repository testpypi


